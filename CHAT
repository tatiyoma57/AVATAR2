<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Bot de Cuencas Hidrol칩gicas</title>
    <style>
        :root {
            --primary-color: #2196F3;
            --primary-dark: #1976D2;
            --accent-color: #4CAF50;
            --accent-dark: #388E3C;
            --danger-color: #F44336;
            --light-bg: #F5F5F5;
            --dark-text: #333333;
            --light-text: #FFFFFF;
            --border-color: #E0E0E0;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-text);
            background-color: var(--light-bg);
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .chat-header {
            background-color: var(--primary-color);
            color: var(--light-text);
            padding: 15px 20px;
            font-size: 1.2rem;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .topic-list {
            background-color: #E3F2FD;
            padding: 10px 20px;
            font-size: 0.9rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .topic-list ul {
            display: flex;
            flex-wrap: wrap;
            list-style-type: none;
            margin-top: 5px;
        }
        
        .topic-list li {
            margin-right: 15px;
            margin-bottom: 5px;
            background-color: #BBDEFB;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .message {
            margin-bottom: 15px;
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 18px;
            position: relative;
            word-wrap: break-word;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bot-message {
            background-color: #E3F2FD;
            color: var(--dark-text);
            border-bottom-left-radius: 5px;
            align-self: flex-start;
        }
        
        .user-message {
            background-color: var(--primary-color);
            color: var(--light-text);
            border-bottom-right-radius: 5px;
            align-self: flex-end;
        }
        
        .bot-message::before {
            content: "游뱄";
            display: inline-block;
            margin-right: 8px;
        }
        
        .user-message::before {
            content: "游녻";
            display: inline-block;
            margin-right: 8px;
        }
        
        .chat-input {
            display: flex;
            padding: 15px;
            background-color: white;
            border-top: 1px solid var(--border-color);
        }
        
        .chat-input input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            font-size: 0.95rem;
            outline: none;
            transition: border 0.3s;
        }
        
        .chat-input input:focus {
            border-color: var(--primary-color);
        }
        
        .chat-input button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 0 20px;
            margin-left: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .chat-input button:hover {
            background-color: var(--primary-dark);
        }
        
        .reset-button {
            background-color: transparent;
            border: none;
            color: var(--light-text);
            font-size: 0.9rem;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .reset-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background-color: #E3F2FD;
            padding: 10px 15px;
            border-radius: 18px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .typing-indicator::after {
            content: '...';
            animation: typing 1.5s infinite;
        }
        
        @keyframes typing {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
        }
        
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .message {
                max-width: 90%;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            Chat Bot de Cuencas Hidrol칩gicas
            <button id="resetButton" class="reset-button">Nueva Conversaci칩n</button>
        </div>
        
        <div class="topic-list">
            <div>Temas disponibles:</div>
            <ul>
                <li>Cuencas hidrol칩gicas</li>
                <li>Hidrolog칤a</li>
                <li>Erosi칩n</li>
                <li>Climatolog칤a</li>
                <li>Cambio clim치tico</li>
            </ul>
        </div>
        
        <div id="chatMessages" class="chat-messages">
            <!-- Los mensajes se a침adir치n aqu칤 din치micamente -->
            <div class="typing-indicator" id="typingIndicator">Escribiendo</div>
        </div>
        
        <div class="chat-input">
            <input type="text" id="userInput" placeholder="Escribe tu mensaje aqu칤..." autocomplete="off">
            <button id="sendButton">Enviar</button>
        </div>
    </div>

    <script>
        // Variables globales
        let userName = "";
        let isWaitingForName = true;
        
        // Elementos del DOM
        const chatMessages = document.getElementById('chatMessages');
        const userInput = document.getElementById('userInput');
        const sendButton = document.getElementById('sendButton');
        const resetButton = document.getElementById('resetButton');
        const typingIndicator = document.getElementById('typingIndicator');
        
        // Funci칩n para a침adir mensaje al chat
        function addMessage(message, isBot = false) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('message');
            messageElement.classList.add(isBot ? 'bot-message' : 'user-message');
            messageElement.textContent = message;
            
            // Insertar antes del indicador de escritura
            chatMessages.insertBefore(messageElement, typingIndicator);
            
            // Scroll autom치tico al 칰ltimo mensaje
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Mostrar indicador de escritura
        function showTyping() {
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Ocultar indicador de escritura
        function hideTyping() {
            typingIndicator.style.display = 'none';
        }
        
        // Procesar la entrada del usuario
        function processUserInput() {
            const message = userInput.value.trim();
            if (!message) return;
            
            // A침adir mensaje del usuario al chat
            addMessage(message);
            userInput.value = '';
            
            // Mostrar que el bot est치 escribiendo
            showTyping();
            
            // Simular tiempo de procesamiento (m치s natural)
            setTimeout(() => {
                hideTyping();
                
                if (isWaitingForName) {
                    handleNameResponse(message);
                } else {
                    processUserQuery(message);
                }
            }, Math.random() * 1000 + 500); // Entre 500ms y 1500ms
        }
        
        // Manejar respuesta del nombre
        function handleNameResponse(text) {
            // Extraer nombre
            let extractedName = "";
            
            if (text.toLowerCase().includes("me llamo ")) {
                extractedName = text.split("me llamo ")[1].split(" ")[0];
            } else if (text.toLowerCase().includes("mi nombre es ")) {
                extractedName = text.split("mi nombre es ")[1].split(" ")[0];
            } else if (text.toLowerCase().includes("soy ")) {
                extractedName = text.split("soy ")[1].split(" ")[0];
            } else {
                // Si no hay patr칩n, usar la primera palabra o todo si es corto
                const nameParts = text.split(" ");
                if (nameParts.length === 1 || text.length < 15) {
                    extractedName = text;
                } else {
                    extractedName = nameParts[0];
                }
            }
            
            // Capitalizar primera letra
            userName = extractedName.charAt(0).toUpperCase() + extractedName.slice(1).toLowerCase();
            
            // Dar la bienvenida al usuario
            const welcomeMessage = `Gracias ${userName}. Soy tu experto en cuencas hidrogr치ficas, hidrolog칤a, erosi칩n, climatolog칤a y cambio clim치tico. 쯈u칠 deseas saber sobre estos temas?`;
            addMessage(welcomeMessage, true);
            
            isWaitingForName = false;
        }
        
        // Procesar la consulta del usuario y generar una respuesta
        function processUserQuery(query) {
            query = query.toLowerCase();
            let response = "";

            // Base de conocimiento extendida con preguntas m치s espec칤ficas
            if (query.includes("cuenca")) {
                if (query.includes("importancia") || query.includes("por qu칠") || query.includes("por que") || query.includes("para qu칠") || query.includes("para que")) {
                    response =
                    `${userName}, las cuencas hidrogr치ficas son importantes porque act칰an como sistemas naturales que capturan y administran el agua. Son esenciales para el suministro de agua, regulan el flujo h칤drico, previenen inundaciones, mantienen ecosistemas saludables y sustentan la biodiversidad.`;
                } else if (query.includes("tipos") || query.includes("clasificaci칩n") || query.includes("clasificacion")) {
                    response =
                    `${userName}, las cuencas hidrogr치ficas se clasifican principalmente en: exorreicas (drenan al mar), endorreicas (drenan a lagos o lagunas internas), y arreicas (donde el agua se evapora o filtra antes de formar corrientes). Tambi칠n pueden clasificarse por tama침o en microcuencas, subcuencas y cuencas.`;
                } else if (query.includes("conservar") || query.includes("proteger") || query.includes("preservar") || query.includes("cuidar")) {
                    response =
                    `${userName}, para conservar las cuencas hidrogr치ficas es fundamental implementar pr치cticas de reforestaci칩n, controlar la erosi칩n, regular el uso del suelo, evitar la contaminaci칩n del agua, promover la agricultura sostenible y establecer 치reas protegidas dentro de la cuenca.`;
                } else {
                    response =
                    `${userName}, las cuencas hidrogr치ficas son 치reas delimitadas donde se recoge, conduce y dispersa el agua de lluvia. Son unidades fundamentales para la gesti칩n del agua y los recursos naturales. 쯊e gustar칤a saber algo m치s espec칤fico sobre ellas, como su manejo o importancia ecol칩gica?`;
                }
            } 
            else if (query.includes("hidrolog칤a") || query.includes("hidrologia")) {
                if (query.includes("ciclo") || query.includes("agua") || query.includes("proceso")) {
                    response =
                    `${userName}, el ciclo hidrol칩gico es el proceso continuo donde el agua circula entre la atm칩sfera, superficie terrestre y subsuelo. Sus principales fases son: evaporaci칩n, condensaci칩n, precipitaci칩n, infiltraci칩n, escorrent칤a y transpiraci칩n. Este ciclo es fundamental para entender los procesos hidrol칩gicos en una cuenca.`;
                } else if (query.includes("modelaci칩n") || query.includes("modelacion") || query.includes("modelo") || query.includes("predecir")) {
                    response =
                    `${userName}, en hidrolog칤a usamos modelos matem치ticos para predecir el comportamiento del agua. Estos pueden ser modelos estad칤sticos, conceptuales o f칤sicamente basados. Herramientas como HEC-HMS, SWAT o MODFLOW nos permiten simular caudales, inundaciones o movimiento de agua subterr치nea para una mejor gesti칩n de recursos h칤dricos.`;
                } else if (query.includes("agua subterr치nea") || query.includes("agua subterranea") || query.includes("acu칤fero") || query.includes("acuifero")) {
                    response =
                    `${userName}, el agua subterr치nea representa aproximadamente el 30% del agua dulce del planeta. Los acu칤feros son formaciones geol칩gicas que almacenan y transmiten agua. Son vitales para el abastecimiento humano y mantienen el flujo base de r칤os durante per칤odos secos. Su sobreexplotaci칩n y contaminaci칩n son problemas graves en muchas regiones.`;
                } else {
                    response =
                    `${userName}, la hidrolog칤a es la ciencia que estudia el comportamiento del agua en nuestro planeta, incluyendo el ciclo hidrol칩gico y la calidad del agua. Permite comprender y gestionar los recursos h칤dricos disponibles. 쯊ienes alguna pregunta espec칤fica sobre estos procesos?`;
                }
            } 
            else if (query.includes("erosi칩n") || query.includes("erosion")) {
                if (query.includes("tipos") || query.includes("formas")) {
                    response =
                    `${userName}, existen varios tipos de erosi칩n: h칤drica (causada por lluvia y escorrent칤a), e칩lica (por viento), glacial (por hielo), y antropog칠nica (actividades humanas). En cuencas hidrogr치ficas, la erosi칩n h칤drica predomina con sus subtipos: laminar, en surcos, c치rcavas y riberas.`;
                } else if (query.includes("control") || query.includes("prevenir") || query.includes("evitar") || query.includes("reducir")) {
                    response =
                    `${userName}, para controlar la erosi칩n en cuencas hidrogr치ficas se implementan medidas como terrazas agr칤colas, barreras vivas, cultivos en curvas de nivel, cobertura vegetal permanente, reforestaci칩n, y estructuras como gaviones y diques. Estas pr치cticas de conservaci칩n de suelos reducen la velocidad del agua y retienen sedimentos.`;
                } else if (query.includes("impacto") || query.includes("consecuencia") || query.includes("efecto")) {
                    response =
                    `${userName}, la erosi칩n deteriora la fertilidad del suelo, reduce la capacidad de retenci칩n de agua, aumenta la sedimentaci칩n en r칤os y embalses (reduciendo su vida 칰til), incrementa el riesgo de inundaciones, afecta la calidad del agua y destruye infraestructura. Tambi칠n contribuye a la desertificaci칩n y p칠rdida de biodiversidad.`;
                } else {
                    response =
                    `${userName}, la erosi칩n es el proceso de desgaste, transporte y sedimentaci칩n de materiales del suelo por diversos agentes como el agua, el viento o la gravedad. En cuencas hidrogr치ficas, la erosi칩n h칤drica es un problema grave que puede causar p칠rdida de suelo f칠rtil, sedimentaci칩n en r칤os y embalses, y aumentar el riesgo de inundaciones. El manejo adecuado de la vegetaci칩n y pr치cticas de conservaci칩n son fundamentales para su control.`;
                }
            } 
            else if (query.includes("climatolog칤a") || query.includes("climatologia") || query.includes("clima")) {
                if (query.includes("factor") || query.includes("influencia") || query.includes("afecta")) {
                    response =
                    `${userName}, los factores clim치ticos que influyen en las cuencas hidrogr치ficas incluyen: precipitaci칩n (cantidad, intensidad, distribuci칩n), temperatura (evaporaci칩n y transpiraci칩n), humedad relativa, radiaci칩n solar, viento y presi칩n atmosf칠rica. Estos elementos determinan el balance h칤drico y el comportamiento hidrol칩gico de la cuenca.`;
                } else if (query.includes("monitoreo") || query.includes("estaci칩n") || query.includes("estacion") || query.includes("medir")) {
                    response =
                    `${userName}, el monitoreo climatol칩gico en cuencas se realiza mediante estaciones meteorol칩gicas que miden precipitaci칩n, temperatura, humedad, radiaci칩n solar y viento. Actualmente, complementamos estas mediciones con sensores remotos, sat칠lites y drones. Estos datos son fundamentales para modelaci칩n hidrol칩gica y sistemas de alerta temprana.`;
                } else if (query.includes("zona") || query.includes("regi칩n") || query.includes("region") || query.includes("diferencia")) {
                    response =
                    `${userName}, las condiciones climatol칩gicas var칤an significativamente entre cuencas seg칰n su ubicaci칩n geogr치fica, altitud y orograf칤a. Cuencas en zonas tropicales tienen reg칤menes de precipitaci칩n diferentes a las de zonas templadas o 치ridas. Las cuencas de monta침a presentan gradientes altitudinales que crean microclimas y afectan los patrones hidrol칩gicos locales.`;
                } else {
                    response =
                    `${userName}, la climatolog칤a estudia el clima y sus variaciones a largo plazo. Para las cuencas hidrogr치ficas, es esencial entender los patrones clim치ticos ya que determinan la disponibilidad de agua. Los factores como precipitaci칩n, temperatura, humedad y vientos influyen directamente en los procesos hidrol칩gicos de una cuenca. Los estudios climatol칩gicos permiten planificar la gesti칩n del agua y prepararse para eventos extremos.`;
                }
            } 
            else if (query.includes("cambio clim치tico") || query.includes("cambio climatico")) {
                if (query.includes("impacto") || query.includes("efecto") || query.includes("consecuencia")) {
                    response =
                    `${userName}, el cambio clim치tico impacta las cuencas hidrogr치ficas mediante alteraciones en patrones de precipitaci칩n, intensificaci칩n de eventos extremos (sequ칤as e inundaciones), reducci칩n de glaciares que alimentan r칤os, elevaci칩n del nivel del mar afectando cuencas costeras, y cambios en los ecosistemas que afectan la calidad y cantidad de agua disponible.`;
                } else if (query.includes("adaptaci칩n") || query.includes("adaptacion") || query.includes("adaptar") || query.includes("enfrentar")) {
                    response =
                    `${userName}, las estrategias de adaptaci칩n al cambio clim치tico en cuencas incluyen: infraestructura verde-azul, restauraci칩n de ecosistemas riparios, sistemas de captaci칩n de agua de lluvia, mejora de eficiencia en uso de agua, diversificaci칩n de fuentes de abastecimiento, seguros contra riesgos clim치ticos y sistemas de alerta temprana para eventos extremos.`;
                } else if (query.includes("mitigaci칩n") || query.includes("mitigacion") || query.includes("reducir") || query.includes("disminuir")) {
                    response =
                    `${userName}, las cuencas hidrogr치ficas contribuyen a mitigar el cambio clim치tico mediante la captura de carbono en bosques y suelos. Estrategias como reforestaci칩n, conservaci칩n de humedales, pr치cticas agr칤colas sostenibles y generaci칩n de energ칤a hidroel칠ctrica sostenible reducen emisiones de gases de efecto invernadero mientras mejoran la resiliencia de la cuenca.`;
                } else {
                    response =
                    `${userName}, el cambio clim치tico est치 alterando los patrones hidrol칩gicos en las cuencas. Se observan fen칩menos como lluvias m치s intensas pero menos frecuentes, aumento de sequ칤as, derretimiento acelerado de glaciares y mayor evaporaci칩n. Estos cambios afectan la disponibilidad y calidad del agua, exigiendo estrategias de adaptaci칩n como infraestructura resiliente, sistemas de alerta temprana y gesti칩n integrada de cuencas. La restauraci칩n de ecosistemas riparios tambi칠n es fundamental para mitigar sus efectos.`;
                }
            } 
            else if (query.includes("ciclo")) {
                response = 
                `${userName}, el ciclo hidrol칩gico es el proceso de circulaci칩n del agua entre la atm칩sfera y la Tierra. Incluye la evaporaci칩n, condensaci칩n, precipitaci칩n, infiltraci칩n, escorrent칤a y transpiraci칩n. En una cuenca hidrogr치fica, este ciclo determina la disponibilidad de agua superficial y subterr치nea. 쮻eseas conocer m치s detalles sobre alguna de estas fases?`;
            } 
            else if (query.includes("inundaci칩n") || query.includes("inundaciones")) {
                response = 
                `${userName}, las inundaciones ocurren cuando el agua desborda los cauces naturales. La gesti칩n de cuencas hidrogr치ficas es fundamental para prevenir y mitigar estos fen칩menos mediante la implementaci칩n de sistemas de alerta temprana, infraestructuras de contenci칩n y planificaci칩n territorial adecuada. El cambio clim치tico est치 intensificando estos eventos en muchas regiones.`;
            } 
            else if (query.includes("sequ칤a") || query.includes("sequia") || query.includes("sequias")) {
                response = 
                `${userName}, las sequ칤as son per칤odos prolongados de d칠ficit de agua que afectan a las cuencas hidrogr치ficas. La gesti칩n sostenible de cuencas puede aumentar la resiliencia frente a estos eventos mediante reservorios, sistemas de recarga de acu칤feros, y protecci칩n de zonas de recarga h칤drica. El monitoreo constante de variables climatol칩gicas e hidrol칩gicas es esencial para anticipar y mitigar sus efectos.`;
            }
            else if (query.includes("manejo") || query.includes("gesti칩n") || query.includes("gestion")) {
                response = 
                `${userName}, el manejo integrado de cuencas hidrogr치ficas es un enfoque hol칤stico que considera todos los recursos y actividades dentro de una cuenca. Busca equilibrar las necesidades humanas con la sostenibilidad ambiental, involucrando a todos los actores en la toma de decisiones. Incluye medidas como reforestaci칩n, terrazas en laderas, control de contaminaci칩n, y regulaci칩n del uso del agua y del suelo.`;
            }
            else if (query.includes("gracias") || query.includes("adi칩s") || query.includes("adios") || query.includes("hasta luego") || query.includes("terminar")) {
                response = `Ha sido un placer ayudarte, ${userName}. Si tienes m치s preguntas sobre cuencas hidrol칩gicas o cualquiera de nuestros temas, no dudes en iniciar una nueva conversaci칩n. 춰Hasta pronto!`;
            } 
            else {
                response =
                `Lo siento, ${userName}, no entend칤 tu consulta. Puedes preguntarme sobre temas como cuencas hidrol칩gicas, hidrolog칤a, erosi칩n, climatolog칤a o cambio clim치tico. 쯈u칠 te gustar칤a saber?`;
            }

            // A침adir respuesta del bot
            addMessage(response, true);
        }
        
        // Reiniciar la conversaci칩n
        function resetChat() {
            // Limpiar todos los mensajes
            while (chatMessages.firstChild) {
                if (chatMessages.firstChild !== typingIndicator) {
                    chatMessages.removeChild(chatMessages.firstChild);
                }
            }
            
            // Reiniciar variables
            isWaitingForName = true;
            userName = "";
            
            // Mensaje inicial
            addMessage("Hola, antes de comenzar, 쯣odr칤as decirme tu nombre?", true);
            
            // Enfocar el campo de entrada
            userInput.focus();
        }
        
        // Event listeners
        sendButton.addEventListener('click', processUserInput);
        
        userInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                processUserInput();
            }
        });
        
        resetButton.addEventListener('click', resetChat);
        
        // Inicializar chat
        window.onload = function() {
            resetChat();
        };
    </script>
</body>
</html>
